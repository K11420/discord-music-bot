# ğŸ› ãƒã‚°ä¿®æ­£ v1.0.2: ãƒ«ãƒ¼ãƒ—ãƒ»å†ç”Ÿæ™‚é–“ãƒ»éŸ³é‡å¤‰æ›´ã®å•é¡Œ

## ğŸ¯ ä¿®æ­£ã•ã‚ŒãŸå•é¡Œ

### 1. âŒ **ãƒ«ãƒ¼ãƒ—ãŒæœ‰åŠ¹ã«ãªã‚‰ãªã„**
**ç—‡çŠ¶**: ãƒ«ãƒ¼ãƒ—ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚‚ã€æ›²ãŒçµ‚ã‚ã‚‹ã¨æ¬¡ã®æ›²ã«é€²ã‚“ã§ã—ã¾ã†

**åŸå› **:
- ãƒ«ãƒ¼ãƒ—ãƒ­ã‚¸ãƒƒã‚¯ã§`state.queue.empty()`ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ãŸ
- ã‚­ãƒ¥ãƒ¼ãŒç©ºã«ãªã‚‹ã¨ãƒ«ãƒ¼ãƒ—ã‹ã‚‰æŠœã‘ã¦ã—ã¾ã†
- ãƒ«ãƒ¼ãƒ—ä¸­ã®æ›²ã®å†è¿½åŠ ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒä¸é©åˆ‡

**ä¿®æ­£å†…å®¹**:
```python
# ä¿®æ­£å‰
if state.loop and voice_client.is_connected() and not state.queue.empty():
    state.queue.put(item)  # ã‚­ãƒ¥ãƒ¼ãŒç©ºã ã¨å®Ÿè¡Œã•ã‚Œãªã„

# ä¿®æ­£å¾Œ
if state.loop and voice_client.is_connected():
    state.queue.put(item)  # å¸¸ã«å†è¿½åŠ 
```

### 2. â±ï¸ **å†ç”Ÿæ™‚é–“ãŒå¤‰ã‚ã‚‰ãªã„**
**ç—‡çŠ¶**: ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã®æ™‚é–“ãŒ00:00ã®ã¾ã¾æ›´æ–°ã•ã‚Œãªã„

**åŸå› **:
- `source.progress`ã®è‡ªå‹•æ›´æ–°ãŒãªã‹ã£ãŸ
- Embedã®æ›´æ–°å‡¦ç†ãŒå®Ÿè£…ã•ã‚Œã¦ã„ãªã‹ã£ãŸ

**ä¿®æ­£å†…å®¹**:
```python
# 1ç§’ã”ã¨ã«progressã‚’æ›´æ–°
while state.playing and voice_client.is_connected():
    await asyncio.sleep(1)
    
    # å†ç”Ÿæ™‚é–“ã‚’æ›´æ–°
    if voice_client.source and not voice_client.is_paused():
        current_source.progress += 1
    
    # 5ç§’ã”ã¨ã«Embedã‚’æ›´æ–°
    last_update += 1
    if last_update >= update_interval:
        updated_embed = self.create_now_playing_embed(...)
        await message.edit(embed=updated_embed, view=view)
        last_update = 0
```

### 3. ğŸ”Š **éŸ³é‡ã®å¤‰æ›´ãŒã§ããªã„**
**ç—‡çŠ¶**: `/volume`ã‚³ãƒãƒ³ãƒ‰ã‚„ãƒœã‚¿ãƒ³ã§éŸ³é‡ãŒå¤‰ã‚ã‚‰ãªã„

**åŸå› **:
- `voice_client.source`ãŒ`PCMVolumeTransformer`ã§ãƒ©ãƒƒãƒ—ã•ã‚Œã¦ã„ã‚‹
- å®Ÿéš›ã®ã‚½ãƒ¼ã‚¹ã¯`source.original`ã«ã‚ã‚‹
- éŸ³é‡å¤‰æ›´ãŒé©åˆ‡ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«é©ç”¨ã•ã‚Œã¦ã„ãªã‹ã£ãŸ

**ä¿®æ­£å†…å®¹**:
```python
# originalã‚½ãƒ¼ã‚¹ã«æ­£ã—ãã‚¢ã‚¯ã‚»ã‚¹
source = voice_client.source
if hasattr(source, 'original'):
    source = source.original

# éŸ³é‡ã‚’å¤‰æ›´
source.volume = new_volume
```

### 4. â©âª **ã‚·ãƒ¼ã‚¯æ©Ÿèƒ½ãŒæœªå®Ÿè£…**
**ç—‡çŠ¶**: forward/reverseãƒœã‚¿ãƒ³ãŒå‹•ä½œã—ãªã„

**åŸå› **: ãƒœã‚¿ãƒ³ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ãŒå®Ÿè£…ã•ã‚Œã¦ã„ãªã‹ã£ãŸ

**ä¿®æ­£å†…å®¹**:
- forward: 10ç§’é€²ã‚ã‚‹
- reverse: 10ç§’æˆ»ã™
- progresså€¤ã‚’ç›´æ¥å¤‰æ›´

---

## âœ¨ æ–°æ©Ÿèƒ½ãƒ»æ”¹å–„

### ğŸ›ï¸ **ãƒœã‚¿ãƒ³æ“ä½œã®å®Œå…¨å®Ÿè£…**

#### **â© Forwardï¼ˆ10ç§’é€²ã‚€ï¼‰**
```python
elif custom_id == "forward":
    new_progress = source.progress + 10
    if new_progress < source.info.duration:
        source.progress = new_progress
```

#### **âª Reverseï¼ˆ10ç§’æˆ»ã™ï¼‰**
```python
elif custom_id == "reverse":
    new_progress = max(0, source.progress - 10)
    source.progress = new_progress
```

#### **ğŸ”Š Volume Upï¼ˆéŸ³é‡ã‚’ä¸Šã’ã‚‹ï¼‰**
```python
elif custom_id == "volume_up":
    new_volume = min(2.0, source.volume + 0.1)
    source.volume = round(new_volume, 1)
```

#### **ğŸ”‰ Volume Downï¼ˆéŸ³é‡ã‚’ä¸‹ã’ã‚‹ï¼‰**
```python
elif custom_id == "volume_down":
    new_volume = max(0.0, source.volume - 0.1)
    source.volume = round(new_volume, 1)
```

### ğŸ“Š **ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã®è‡ªå‹•æ›´æ–°**

- **1ç§’ã”ã¨**: å†…éƒ¨çš„ã«å†ç”Ÿæ™‚é–“ã‚’æ›´æ–°
- **5ç§’ã”ã¨**: Embedã‚’æ›´æ–°ã—ã¦ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’è¡¨ç¤º
- **ä¸€æ™‚åœæ­¢ä¸­**: æ™‚é–“ã‚’é€²ã‚ãªã„

### ğŸ”„ **ãƒ«ãƒ¼ãƒ—æ©Ÿèƒ½ã®æ”¹å–„**

- ãƒ«ãƒ¼ãƒ—æœ‰åŠ¹æ™‚ã¯æ›²ã‚’ç„¡é™ã«å†ç”Ÿ
- ã‚­ãƒ¥ãƒ¼ã®çŠ¶æ…‹ã«é–¢ä¿‚ãªãå‹•ä½œ
- ãƒ«ãƒ¼ãƒ—ä¸­ã¯ã€Œå†ç”Ÿçµ‚äº†ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ãªã„

---

## ğŸ”§ æŠ€è¡“çš„ãªè©³ç´°

### **PCMVolumeTransformer ã®ç†è§£**

Discord.pyã§ã¯ã€éŸ³å£°ã‚½ãƒ¼ã‚¹ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ï¼š

```
PCMVolumeTransformer (éŸ³é‡åˆ¶å¾¡)
  â””â”€ original: YTDLSource/DiscordFileSource (å®Ÿéš›ã®éŸ³å£°)
       â””â”€ source: FFmpegPCMAudio (FFmpeg)
```

éŸ³é‡ã‚„ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã€`original`ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

```python
# æ­£ã—ã„ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•
source = voice_client.source
if hasattr(source, 'original'):
    source = source.original  # å®Ÿéš›ã®ã‚½ãƒ¼ã‚¹
source.volume = new_volume
```

### **å†ç”Ÿæ™‚é–“ã®è¿½è·¡**

```python
class YTDLSource(PCMVolumeTransformer):
    def __init__(self, ..., progress: float = 0):
        self.progress = progress  # ç§’å˜ä½
```

å†ç”Ÿä¸­ã¯1ç§’ã”ã¨ã«`progress`ã‚’å¢—ã‚„ã™ã“ã¨ã§è¿½è·¡ï¼š

```python
while state.playing:
    await asyncio.sleep(1)
    if not voice_client.is_paused():
        current_source.progress += 1
```

### **ãƒ«ãƒ¼ãƒ—ã®å®Ÿè£…**

```python
# æ›²ãŒçµ‚äº†ã—ãŸå¾Œ
if state.loop and voice_client.is_connected():
    state.queue.put(item)  # åŒã˜æ›²ã‚’å†åº¦ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ 

# ãƒ«ãƒ¼ãƒ—ä¸­ã¯çµ‚äº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ãªã„
if not state.loop:
    embed = self.create_now_playing_embed(source, voice_client, finished=True)
    await message.edit(embed=embed, view=None)
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ–¹æ³•

### **1. ãƒ«ãƒ¼ãƒ—æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ**
```
1. /play ã§æ›²ã‚’å†ç”Ÿ
2. ğŸ”„ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆèµ¤è‰²ã«å¤‰ã‚ã‚‹ï¼‰
3. æ›²ãŒçµ‚ã‚ã£ãŸã‚‰åŒã˜æ›²ãŒå†åº¦å†ç”Ÿã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
```

### **2. å†ç”Ÿæ™‚é–“ã®ãƒ†ã‚¹ãƒˆ**
```
1. æ›²ã‚’å†ç”Ÿ
2. Embedã®ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ãŒ5ç§’ã”ã¨ã«æ›´æ–°ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
3. æ™‚é–“è¡¨ç¤ºãŒå¢—ãˆã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
```

### **3. éŸ³é‡å¤‰æ›´ã®ãƒ†ã‚¹ãƒˆ**
```
# ã‚³ãƒãƒ³ãƒ‰ã§ãƒ†ã‚¹ãƒˆ
/volume 0.8

# ãƒœã‚¿ãƒ³ã§ãƒ†ã‚¹ãƒˆ
ğŸ”Š+ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ éŸ³é‡ãŒä¸ŠãŒã‚‹
ğŸ”Š- ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ éŸ³é‡ãŒä¸‹ãŒã‚‹
```

### **4. ã‚·ãƒ¼ã‚¯æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ**
```
â© ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ 10ç§’é€²ã‚€
âª ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ 10ç§’æˆ»ã‚‹
```

---

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### **Embedæ›´æ–°ã®æœ€é©åŒ–**
- 1ç§’ã”ã¨ã§ã¯ãªã5ç§’ã”ã¨ã«æ›´æ–°
- Discord APIã®è² è·ã‚’è»½æ¸›
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã¯ååˆ†

### **éåŒæœŸå‡¦ç†**
- `asyncio.sleep(1)`ã§åŠ¹ç‡çš„ãªå¾…æ©Ÿ
- ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ãªã—

---

## ğŸš¨ æ—¢çŸ¥ã®åˆ¶é™äº‹é …

### **ã‚·ãƒ¼ã‚¯æ©Ÿèƒ½ã®åˆ¶é™**
ç¾åœ¨ã®ã‚·ãƒ¼ã‚¯å®Ÿè£…ã¯`progress`å¤‰æ•°ã®å¤‰æ›´ã®ã¿ã§ã€å®Ÿéš›ã®FFmpegã‚¹ãƒˆãƒªãƒ¼ãƒ ã¯å¤‰æ›´ã—ã¦ã„ã¾ã›ã‚“ã€‚
ãã®ãŸã‚ã€**è¡¨ç¤ºä¸Šã®æ™‚é–“ã¯å¤‰ã‚ã‚Šã¾ã™ãŒã€å®Ÿéš›ã®å†ç”Ÿä½ç½®ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“**ã€‚

ã‚ˆã‚Šé«˜åº¦ãªã‚·ãƒ¼ã‚¯æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã«ã¯ï¼š
```python
# FFmpegã‚’å†èµ·å‹•ã—ã¦æŒ‡å®šä½ç½®ã‹ã‚‰å†ç”Ÿ
new_source = self.seekMusic(source, new_position)
voice_client.source = new_source
```

ã“ã®æ©Ÿèƒ½ã¯å°†æ¥ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§å®Ÿè£…äºˆå®šã§ã™ã€‚

### **éŸ³é‡å¤‰æ›´ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§**
éŸ³é‡å¤‰æ›´ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§åæ˜ ã•ã‚Œã¾ã™ãŒã€éå¸¸ã«é«˜é€Ÿã«é€£ç¶šã§å¤‰æ›´ã™ã‚‹ã¨ã€
Discord APIã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã«å¼•ã£ã‹ã‹ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

---

## ğŸ‰ ã¾ã¨ã‚

v1.0.2ã§ã¯ä»¥ä¸‹ã®é‡è¦ãªå•é¡ŒãŒä¿®æ­£ã•ã‚Œã¾ã—ãŸï¼š

âœ… **ãƒ«ãƒ¼ãƒ—æ©Ÿèƒ½ãŒæ­£å¸¸ã«å‹•ä½œ**  
âœ… **å†ç”Ÿæ™‚é–“ãŒæ­£ã—ãè¡¨ç¤ºãƒ»æ›´æ–°**  
âœ… **éŸ³é‡å¤‰æ›´ãŒãƒœã‚¿ãƒ³ãƒ»ã‚³ãƒãƒ³ãƒ‰ã§å‹•ä½œ**  
âœ… **ã‚·ãƒ¼ã‚¯æ©Ÿèƒ½ã®åŸºæœ¬å®Ÿè£…**  
âœ… **ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã®è‡ªå‹•æ›´æ–°**

ã“ã‚Œã‚‰ã®ä¿®æ­£ã«ã‚ˆã‚Šã€Discord Music BotãŒã‚ˆã‚Šä½¿ã„ã‚„ã™ãã€ä¿¡é ¼æ€§ã®é«˜ã„ã‚‚ã®ã«ãªã‚Šã¾ã—ãŸï¼

---

**ä¿®æ­£æ—¥**: 2024å¹´10æœˆ13æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v1.0.2  
**ã‚³ãƒŸãƒƒãƒˆ**: eb7f8d8